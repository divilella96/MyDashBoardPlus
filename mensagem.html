<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerar Report Bloqueio WhatsApp</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      text-align: center;
      padding: 40px;
    }

    input, textarea, select {
      width: 80%;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 15px;
    }

    textarea {
      height: 100px;
    }

    button {
      padding: 12px 24px;
      font-size: 15px;
      background-color: #25d366;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    button:hover {
      background-color: #1ebe57;
    }

    /* Campos extras escondidos por padrão */
    #bloqueioOutro, #detalhesSubstituicao {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Gerar Report Bloqueio</h1>

  <input type="text" id="numero" placeholder="Número com DDI (ex: 351912345678)"><br>
  <input type="text" id="encomenda" placeholder="Número da encomenda (ex: 00035625 / 530729)"><br>
  
  <!-- Combo para Tipo de Bloqueio -->
 <select id="bloqueio" onchange="mostrarOutro()">
    <option value="">-- Selecione o tipo de bloqueio --</option>
    <option>Erro "encomenda em processamento"</option>
    <option>O valor do pedido é superior ao valor permitido</option>
    <option>Erro de duplicidade</option>
    <option>Erro descohecido</option>
    <option>Outro (especificar abaixo)</option>
  </select><br>
  
  <!-- Campo só aparece se for "Outro" -->
  <input type="text" id="bloqueioOutro" placeholder="Digite o tipo de bloqueio"><br>

  <!-- Combo Substituição -->
  <select id="substituicao" onchange="mostrarDescricaoSubstituicao()">
    <option value="">-- Houve substituição? --</option>
    <option>Sim, teve substituição</option>
    <option>Não teve substituição</option>
    <option>Não teve substituição mas quero adicionar nota/descrição</option>
  </select><br>

  <!-- Campo descrição só aparece se for necessário -->
  <textarea id="detalhesSubstituicao" placeholder="Descreva os artigos substituídos ou a nota adicional..."></textarea><br>

  <input type="text" id="ticket" placeholder="Ticket do suporte (ex: 1832377)"><br>

  <button onclick="gerarMensagem()">Gerar Mensagem</button>
  <button onclick="enviarWhatsApp()">Abrir no WhatsApp</button>

  <h3>Prévia da Mensagem:</h3>
  <pre id="preview" style="text-align:left; background:#fff; padding:15px; border:1px solid #ccc; border-radius:8px; white-space:pre-wrap;"></pre>

  <script>
    let mensagemGerada = "";

    function mostrarOutro() {
      const select = document.getElementById("bloqueio");
      const outroCampo = document.getElementById("bloqueioOutro");

      if (select.value === "Outro (especificar abaixo)") {
        outroCampo.style.display = "block";
      } else {
        outroCampo.style.display = "none";
        outroCampo.value = "";
      }
    }

    function mostrarDescricaoSubstituicao() {
      const select = document.getElementById("substituicao");
      const campoDescricao = document.getElementById("detalhesSubstituicao");

      if (
        select.value === "Sim, teve substituição" ||
        select.value === "Não teve substituição mas quero adicionar nota/descrição"
      ) {
        campoDescricao.style.display = "block";
      } else {
        campoDescricao.style.display = "none";
        campoDescricao.value = "";
      }
    }

    function gerarMensagem() {
      const encomenda = document.getElementById("encomenda").value;
      let bloqueio = document.getElementById("bloqueio").value;
      const bloqueioOutro = document.getElementById("bloqueioOutro").value;
      const substituicao = document.getElementById("substituicao").value;
      const detalhes = document.getElementById("detalhesSubstituicao").value;
      const ticket = document.getElementById("ticket").value;

      // Se escolheu "Outro", usa o texto digitado
      if (bloqueio === "Outro (especificar abaixo)" && bloqueioOutro.trim() !== "") {
        bloqueio = bloqueioOutro;
      }

      let textoSubstituicao = substituicao;
      if (detalhes.trim() !== "") {
        textoSubstituicao += `\n\n${detalhes}`;
      }

      mensagemGerada = 
`Report Bloqueio

Encomenda: ${encomenda}
Tipo do Bloqueio: ${bloqueio}
Substituição: ${textoSubstituicao}

Já contactado o 2370

Ticket: ${ticket}`;

      document.getElementById("preview").innerText = mensagemGerada;
    }

    function enviarWhatsApp() {
      const numero = document.getElementById("numero").value;
      if (!numero || !mensagemGerada) {
        alert("Preencha o número e gere a mensagem antes de enviar!");
        return;
      }
      const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagemGerada)}`;
      window.open(url, "_blank");
    }
  </script>
</body>
</html>
