<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerar Report Bloqueio WhatsApp</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      text-align: center;
      padding: 40px;
    }

    input, textarea, select {
      width: 80%;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 15px;
    }

    textarea {
      height: 100px;
    }

    button {
      padding: 12px 24px;
      font-size: 15px;
      background-color: #25d366;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    button:hover {
      background-color: #1ebe57;
    }

    /* Campos extras escondidos por padr√£o */
    #bloqueioOutro, #detalhesSubstituicao {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Gerar Report Bloqueio</h1>

  <label for="numero">N√∫mero WhatsApp</label><br>
  <input type="tel" id="numero" placeholder="+351 912 345 678" inputmode="numeric"><br><br>
  
  <label for="encomenda">N√∫mero da Encomenda</label><br>
  <input type="tel" id="encomenda" placeholder="00035625 / 530729" inputmode="numeric"><br><br>
  
  <!-- Combo para Tipo de Bloqueio -->
 <select id="bloqueio" onchange="mostrarOutro()">
    <option value="">-- Selecione o tipo de bloqueio --</option>
    <option>Erro "encomenda em processamento"</option>
    <option>O valor do pedido √© superior ao valor permitido</option>
    <option>Erro de duplicidade</option>
    <option>Erro descohecido</option>
    <option>Outro (especificar abaixo)</option>
  </select><br>
  
  <!-- Campo s√≥ aparece se for "Outro" -->
  <input type="text" id="bloqueioOutro" placeholder="Digite o tipo de bloqueio"><br>

  <!-- Combo Substitui√ß√£o -->
  <select id="substituicao" onchange="mostrarDescricaoSubstituicao()">
    <option value="">-- Houve substitui√ß√£o? --</option>
    <option>Sim, teve substitui√ß√£o</option>
    <option>N√£o teve substitui√ß√£o</option>
    <option>N√£o teve substitui√ß√£o mas quero adicionar nota/descri√ß√£o</option>
  </select><br>

  <!-- Campo descri√ß√£o s√≥ aparece se for necess√°rio -->
  <textarea id="detalhesSubstituicao" placeholder="Descreva os artigos substitu√≠dos ou a nota adicional..."></textarea><br>

  <label for="ticket">Ticket</label><br>
  <input type="number" id="ticket" placeholder="1832377" inputmode="numeric"><br><br>

  <button onclick="gerarMensagem()">Gerar Mensagem</button>
  <button onclick="enviarWhatsApp()">Abrir no WhatsApp</button>

  <h3>Pr√©via da Mensagem:</h3>
  <pre id="preview" style="text-align:left; background:#fff; padding:15px; border:1px solid #ccc; border-radius:8px; white-space:pre-wrap;"></pre>

  <script>
    let mensagemGerada = "";

    function mostrarOutro() {
      const select = document.getElementById("bloqueio");
      const outroCampo = document.getElementById("bloqueioOutro");

      if (select.value === "Outro (especificar abaixo)") {
        outroCampo.style.display = "block";
      } else {
        outroCampo.style.display = "none";
        outroCampo.value = "";
      }
    }

    function mostrarDescricaoSubstituicao() {
      const select = document.getElementById("substituicao");
      const campoDescricao = document.getElementById("detalhesSubstituicao");

      if (
        select.value === "Sim, teve substitui√ß√£o" ||
        select.value === "N√£o teve substitui√ß√£o mas quero adicionar nota/descri√ß√£o"
      ) {
        campoDescricao.style.display = "block";
      } else {
        campoDescricao.style.display = "none";
        campoDescricao.value = "";
      }
    }

    function gerarMensagem() {
      const encomenda = document.getElementById("encomenda").value;
      let bloqueio = document.getElementById("bloqueio").value;
      const bloqueioOutro = document.getElementById("bloqueioOutro").value;
      const substituicao = document.getElementById("substituicao").value;
      const detalhes = document.getElementById("detalhesSubstituicao").value;
      const ticket = document.getElementById("ticket").value;

      // Se escolheu "Outro", usa o texto digitado
      if (bloqueio === "Outro (especificar abaixo)" && bloqueioOutro.trim() !== "") {
        bloqueio = bloqueioOutro;
      }

      let textoSubstituicao = substituicao;
      if (detalhes.trim() !== "") {
        textoSubstituicao += `\n\n${detalhes}`;
      }

      mensagemGerada = 
`Report Bloqueio

Encomenda: ${encomenda}
Tipo do Bloqueio: ${bloqueio}
Substitui√ß√£o: ${textoSubstituicao}

J√° contactado o 2370

Ticket: ${ticket}`;

      document.getElementById("preview").innerText = mensagemGerada;
    }

    function enviarWhatsApp() {
      const numero = document.getElementById("numero").value;
      if (!numero || !mensagemGerada) {
        alert("Preencha o n√∫mero e gere a mensagem antes de enviar!");
        return;
      }
      const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagemGerada)}`;
      window.open(url, "_blank");
    }

      // üì± M√°scara para telefone internacional (+351 912 345 678)
  document.getElementById("numero").addEventListener("input", function(e) {
    let valor = e.target.value.replace(/\D/g, ""); // remove tudo que n√£o for n√∫mero
    if(valor.startsWith("351")) {
      valor = "+" + valor.replace(/^351/, "351 "); // adiciona + e espa√ßo
    } else if(valor.startsWith("55")) {
      valor = "+" + valor.replace(/^55/, "55 "); // ex. Brasil
    }
    valor = valor.replace(/(\+\d{2,3})(\d{3})(\d{3})(\d{3})$/, "$1 $2 $3 $4");
    e.target.value = valor;
  });

  // üì¶ M√°scara para encomenda (00035625 / 530729)
  document.getElementById("encomenda").addEventListener("input", function(e) {
    let valor = e.target.value.replace(/\D/g, ""); // s√≥ n√∫meros
    if (valor.length > 8) {
      valor = valor.slice(0, 8) + " / " + valor.slice(8);
    }
    e.target.value = valor;
  });

  // üé´ Ticket s√≥ n√∫meros (remove letras automaticamente)
  document.getElementById("ticket").addEventListener("input", function(e) {
    e.target.value = e.target.value.replace(/\D/g, ""); 
  });
  </script>
 


</body>
</html>
