<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lyzer Tech - Ferramentas</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container"> 
    <h1>Ferramentas de Operações</h1>
    <div class="coluna">
      <h2>Geral</h2>
      <button class="btn-primary" onclick="window.open('aviso_atraso.html', '_blank')">Avisar cliente sobre atraso</button>
      <button class="btn-primary" onclick="window.open('comunicacao_bot.html', '_blank')">Comunicação Com Bot</button>
      <button class="btn-primary" onclick="window.open('mapa_emel.html', '_blank')">Validar Mapa EMEL</button>
      <h2>Rato</h2>
      <button class="btn-primary" onclick="abrirOrderManagementRato()">Rato - Encomendas e C&C</button>
      <button class="btn-primary" onclick="abrirOrderManagementRatoAlt()">Rato - Encomendas (Alt)</button>
      <button class="btn-primary" onclick="abrirLiveOperationsRato()">Rato - Em Direto</button>
      <button class="btn-primary" onclick="abrirMensagemWhatsApp()">Gerar mensagem WhatsApp</button>
      <button class="btn-primary" onclick="abrirPaginaContato()">E-mail Artigo Esquecido</button>
      <h2>São Bento</h2>
      <button class="btn-primary" onclick="abrirOrderManagementSaoBento()">São Bento - Encomendas e C&C</button>
      <button class="btn-primary" onclick="abrirOrderManagementSaoBentoAlt()">São Bento - Encomendas (Alt)</button>
    </div>
  </div>

  <script>
    function abrirPaginaContato() {
      window.open("contact.html", "_blank");
    }

    function getStatusList() {
      return ["Pending","InAssignment","Open","Invoicing","Processing","Complete","InTransit","Incidence"];
    }

    function getFullStatusList() {
      return [...getStatusList(),"Cancelled","ManualAssignment"];
    }

    function abrirOrderManagementRatoAlt() {
      const agora = getLocalISOString(new Date());
      const url = new URL("https://prd-swiftso.azurewebsites.net/pt/app/operations/order-management");
      url.searchParams.append("dateRange[from]", agora);
      url.searchParams.append("stores", "133");
      const statuses = ["Pending", "InAssignment", "Open", "Invoicing", "Processing", "Complete", "InTransit", "Incidence"];
      statuses.forEach(status => url.searchParams.append("status", status));
      url.searchParams.append("pageIndex", "1");
      url.searchParams.append("pageSize", "50");
      window.open(url.toString(), "_blank");
    }

    function abrirOrderManagementRato() {
      const agora = getLocalISOString(new Date());
      const url = new URL("https://perform.lyzer.tech/pt/app/operations/order-management");
      url.searchParams.append("dateRange[from]", agora);
      url.searchParams.append("stores", "133");
      const statuses = ["Pending", "InAssignment", "Open", "Invoicing", "Processing", "Complete", "InTransit", "Incidence"];
      statuses.forEach(status => url.searchParams.append("status", status));
      url.searchParams.append("pageIndex", "1");
      url.searchParams.append("pageSize", "50");
      window.open(url.toString(), "_blank");
    }

    function abrirOrderManagementSaoBentoAlt() {
      const agora = getLocalISOString(new Date());
      const url = new URL("https://prd-swiftso.azurewebsites.net/pt/app/operations/order-management");
      url.searchParams.append("dateRange[from]", agora);
      url.searchParams.append("stores", "244");
      const statuses = ["Pending", "InAssignment", "Open", "Invoicing", "Processing", "Complete", "InTransit", "Incidence"];
      statuses.forEach(status => url.searchParams.append("status", status));
      url.searchParams.append("pageIndex", "1");
      url.searchParams.append("pageSize", "50");
      window.open(url.toString(), "_blank");
    }

    function abrirOrderManagementSaoBento() {
      const agora = getLocalISOString(new Date());
      const url = new URL("https://perform.lyzer.tech/pt/app/operations/order-management");
      url.searchParams.append("dateRange[from]", agora);
      url.searchParams.append("stores", "244");
      const statuses = ["Pending", "InAssignment", "Open", "Invoicing", "Processing", "Complete", "InTransit", "Incidence"];
      statuses.forEach(status => url.searchParams.append("status", status));
      url.searchParams.append("pageIndex", "1");
      url.searchParams.append("pageSize", "50");
      window.open(url.toString(), "_blank");
    }

    function abrirLiveOperationsRato() {
      const agora = getLocalISOString(new Date());
      const url = new URL("https://perform.lyzer.tech/pt/app/operations/live-operations");
      url.searchParams.append("deliveryDeadline", agora);
      url.searchParams.append("retailer", "29");
      url.searchParams.append("store", "133");
      url.searchParams.append("serviceType", "190");
      getFullStatusList().forEach(status => url.searchParams.append("status", status));
      url.searchParams.append("pageIndex", "1");
      url.searchParams.append("pageSize", "20");
      window.open(url.toString(), "_blank");
    }

    function abrirMensagemWhatsApp() {
      window.open("mensagem.html", "_blank");
    }

    function getLocalISOString(date) {
      const offset = date.getTimezoneOffset();
      const dateWithOffset = new Date(date.getTime() - (offset * 60 * 1000));
      return dateWithOffset.toISOString().slice(0, -1);
    }
  </script>
</body>
</html>
